<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>&lt;no title&gt;</title>
    
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> 
  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">geogg122</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="code python highlight-python"><div class="highlight"><pre><span class="c"># example of importing a module</span>
<span class="c"># here, we want the method factorial</span>
<span class="c"># from the library called math</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">factorial</span>

<span class="c"># perform an inefficient prime number test</span>
<span class="c">#</span>
<span class="c"># Wilson&#39;s theorum</span>
<span class="c"># http://mathworld.wolfram.com/WilsonsTheorem.html</span>
<span class="c"># states that p is a prime number</span>
<span class="c"># iff (p-1)! == -1, mod p</span>

<span class="c"># test number</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">7919</span>

<span class="c"># calculate the factorial</span>
<span class="n">p1_fact</span> <span class="o">=</span> <span class="n">factorial</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># do the comparison in modulo p</span>
<span class="n">is_prime</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1_fact</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span>

<span class="k">if</span> <span class="n">is_prime</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">p</span><span class="p">,</span><span class="s">&quot;is a prime number&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">p</span><span class="p">,</span><span class="s">&quot;is not a prime number&quot;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>7919 is a prime number
</pre></div>
</div>
<p>As an example of data masking, consider the QA mask in the <a class="reference external" href="https://lpdaac.usgs.gov/products/modis_products_table/leaf_area_index_fraction_of_photosynthetically_active_radiation/8_day_l4_global_1km/mod15a2">MODIS Leaf
Area Index
(LAI)</a><span class="link-target"> [https://lpdaac.usgs.gov/products/modis_products_table/leaf_area_index_fraction_of_photosynthetically_active_radiation/8_day_l4_global_1km/mod15a2]</span>
product:</p>
<table><tr><td><p>Bit number</p>
</td><td><p>Parameter Name</p>
</td><td><p>Bit combination</p>
</td><td><p>Interpretation</p>
</td></tr><tr><td><p>0</p>
</td><td><p>MODLAND_QC bits</p>
</td><td><p>0</p>
</td><td><p>Good quality (main algorithm with or without saturation)</p>
</td></tr><tr><td></td><td></td><td><p>1</p>
</td><td><p>Other Quality (back-up algorithm or fill values)</p>
</td></tr><tr><td><p>1</p>
</td><td><p>Sensor</p>
</td><td><p>0</p>
</td><td><p>Terra</p>
</td></tr><tr><td></td><td></td><td><p>1</p>
</td><td><p>Aqua</p>
</td></tr><tr><td><p>2</p>
</td><td><p>DeadDetector</p>
</td><td><p>0</p>
</td><td><p>Detectors apparently fine for up to 50% of channels</p>
</td></tr><tr><td></td><td></td><td><p>1</p>
</td><td><p>Dead detectors caused &gt;50% adjacent detector retrieval</p>
</td></tr><tr><td><p>3-4</p>
</td><td><p>CloudState</p>
</td><td><p>00</p>
</td><td><p>Significant clouds NOT present (clear)</p>
</td></tr><tr><td></td><td></td><td><p>01</p>
</td><td><p>Significant clouds WERE present</p>
</td></tr><tr><td></td><td></td><td><p>10</p>
</td><td><p>Mixed cloud present on pixel</p>
</td></tr><tr><td></td><td></td><td><p>11</p>
</td><td><p>Cloud state not defined (assumed clear)</p>
</td></tr><tr><td><p>5-7</p>
</td><td><p>CF_QC</p>
</td><td><p>000</p>
</td><td><p>Main (RT) method used (best result possible (no saturation))</p>
</td></tr><tr><td></td><td></td><td><p>001</p>
</td><td><p>Main (RT) method used with saturation. (usable)</p>
</td></tr><tr><td></td><td></td><td><p>010</p>
</td><td><p>Main (RT) method failed due to bad geometry (empirical algorithm used)</p>
</td></tr><tr><td></td><td></td><td><p>010</p>
</td><td><p>Main (RT) method failed due to problems other than geometry (empirical
algorithm used)</p>
</td></tr><tr><td></td><td></td><td><p>010</p>
</td><td><p>Pixel not produced at all.</p>
</td></tr></table><p>So, the MODIS LAI QA information is contained in one byte (8 bits),
which encodes data about five different categories of QA information.</p>
<p>When using such data, we need to make choices about what quality of data
we are willing to accept.</p>
<p>For the moment, you can ignore this piece of code below. We will learn
of such things later, but here we read in some data into a variable
<tt class="docutils literal"><span class="pre">qa</span></tt>, and diaplay those data:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># jump ahead a bit in the course</span>
<span class="c"># to read some data in from a npz file</span>
<span class="c"># and show it</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;data/MCD15A2.A2011185.h09v05.005.npz&#39;</span><span class="p">)</span>
<span class="n">lai</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;lai&#39;</span><span class="p">]</span>
<span class="n">lai_sd</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;lai_sd&#39;</span><span class="p">]</span>
<span class="n">qa</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;qc&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">qa</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0x106b92320&gt;
</pre></div>
</div>
<img alt="../_images/spares_3_1.png" src="../_images/spares_3_1.png" />
<p>We now want to be able to interpret those qa codes:</p>
<p>From the table above, we want to access the <tt class="docutils literal"><span class="pre">MODLAND_QC</span> <span class="pre">bits</span></tt> which
are in the first bit of this:</p>
<p>We can simply access this applying a bitwise and operation with bit mask
of value 1 (to pull the information on the first bit). This then will
have values of zero or one. We can convert these to <tt class="docutils literal"><span class="pre">bool</span></tt>,so now zero
values are <tt class="docutils literal"><span class="pre">False</span></tt>.</p>
<p>The table above tells us that we want values of zero here, so we take a
ones complement so that <tt class="docutils literal"><span class="pre">mask</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt> where we want the data.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="p">((</span><span class="n">qa</span> <span class="o">&amp;</span> <span class="mi">0</span><span class="n">b1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0x11401d8c0&gt;
</pre></div>
</div>
<img alt="../_images/spares_5_1.png" src="../_images/spares_5_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="p">((</span><span class="n">qa</span> <span class="o">&amp;</span> <span class="mi">0</span><span class="n">b1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">lai</span><span class="o">*</span><span class="n">mask</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0x115143d40&gt;
</pre></div>
</div>
<img alt="../_images/spares_6_1.png" src="../_images/spares_6_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="p">((</span><span class="n">qa</span> <span class="o">&amp;</span> <span class="mi">0</span><span class="n">b1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">lai_sd</span><span class="o">*</span><span class="n">mask</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0x1151cfef0&gt;
</pre></div>
</div>
<img alt="../_images/spares_7_1.png" src="../_images/spares_7_1.png" />


          </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
        &copy; Copyright 2014, Prof. P. Lewis.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>